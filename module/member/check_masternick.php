<?php
/* vim: set expandtab tabstop=4 shiftwidth=4 foldmethod=marker: */
/**
* 파일명: member/check_masterid.php
* 작성일: 2006-03-08
* 작성자: 이범민
* 설  명: tab_member에서 중복여부 체크
*****************************************************************
* 
*/
$JSON = WebApp::singleton('JSON');
$id = $_REQUEST['id'];



    $except_id = array(
        'guest','admin','kt','file','host','hosts','list','podo','asdf','search','master','tweb',
        'email','mail','ns','mx','find','book','bookmart','podoweb','test','drbum','jsseo','cis'
		// 자판에 있는 것
					
		);


		$exp_text = array('~','`','!','@','#','$','%','^','&','*','(',')','-','+',
					'_','=','|','}',']','[','{','?',
					// 원문자
					'㉠','㉡','㉢','㉣','㉤','㉥','㉦','㉧','㉨','㉩',
					'㉪','㉫','㉬','㉭','㉮','㉯','㉰','㉱','㉲','㉳',
					 '㉴','㉵','㉶','㉷','㉸','㉹','㉺','㉻','ⓐ','ⓑ',
					'ⓒ','ⓓ','ⓔ','ⓕ','ⓖ','ⓗ','ⓘ','ⓙ','ⓚ','ⓛ',
					'ⓜ','ⓝ','ⓞ','ⓟ','ⓠ','ⓡ','ⓢ','ⓣ','ⓤ','ⓥ',
					'ⓦ','ⓧ','ⓨ','ⓩ','①','②','③','④','⑤','⑥',
					'⑦','⑧','⑨','⑩','⑪','⑫','⑬','⑭','⑮',
					// 괄호문자
					'㈀','㈁','㈂','㈃','㈄','㈅','㈆','㈇','㈈','㈉',
					'㈊','㈋','㈌','㈍','㈎','㈏','㈐','㈑','㈒','㈓',
					'㈔','㈕','㈖','㈗','㈘','㈙','㈚','㈛','⒜','⒝',
					'⒞','⒟','⒠','⒡','⒢','⒣','⒤','⒥','⒦','⒧',
					'⒨','⒩','⒪','⒫','⒬','⒭','⒮','⒯','⒰','⒱',
					'⒲','⒳','⒴','⒵','⑴','⑵','⑶','⑷','⑸','⑹',
					'⑺','⑻','⑼','⑽','⑾','⑿','⒀','⒁','⒂',
					// 단위기호
					'′','″','℃','Å','￠','￡','￥','¤','℉','‰','＄','％','Ｆ','￦',
					'㎕','㎖','㎗','ℓ','㎘','㏄','㎣','㎤','㎥','㎦',
					'㎙','㎚','㎛','㎜','㎝','㎞','㎟','㎠','㎡','㎢',
					'㏊','㎍','㎎','㎏','㏏','㎈','㎉','㏈','㎧','㎨',
					'㎰','㎱','㎲','㎳','㎴','㎵','㎶','㎷','㎸','㎹',
					'㎀','㎁','㎂','㎃','㎄','㎺','㎻','㎼','㎽','㎾',
					'㎿','㎐','㎑','㎒','㎓','㎔','Ω','㏀','㏁','㎊',
					'㎋','㎌','㏖','㏅','㎭','㎮','㎯','㏛','㎩','㎪',
					'㎫','㎬','㏝','㏐','㏓','㏃','㏉','㏜','㏆',
					// 첨자기호
					'½','⅓','⅔','¼','¾','⅛','⅜','⅝','⅞',
					'¹','²','³','⁴','ⁿ','₁','₂','₃','₄',
					// 일반기호
					'§','※','☆','★','○','●','◎','◇','◆','□','■','△','▽','→',
					'←','↑','↓','↔','〓','◁','◀','▷','▶','♤','♠','♡','♥','♧',
					'♣','⊙','◈','▣','◐','◑','▒','▤','▥','▨','▧','▦','▩','♨',
					'☏','☎','☜','☞','¶','†','‡','↕','↗','↙','↖','↘','♭','♩',
					'♪','♬','㉿','㈜','№','㏇','™','㏂','㏘','℡','＃','＆','＊','＠','ª','º',
					//기술기호
					'、','。','·','‥','…','¨','〃','­','―','∥','＼','∼','´','～','ˇ',
					'˘','˝','˚','˙','¸','˛','¡','¿','ː','！','＇','，','．','／','：','；','？','＾','＿','｀','｜','￣',
					//학술기호
					'±','×','÷','≠','≤','≥','∞','∴','♂','♀','∠','⊥','⌒','∂','∇','≡',
					'≒','≪','≫','√','∽','∝','∵','∫','∬','∈','∋','⊆','⊇','⊂','⊃','∪','∩',
					'∧','∨','￢','⇒','⇔','∀','∃','∮','∑','∏','＋','－','＜','＝','＞');

header('Content-Encoding: cp949');
			for($ii=0; $ii<count($exp_text); $ii++) {
				if(strstr($id,$exp_text[$ii])) {
					$nn = 'Y';
				}
			}


    $DB = &WebApp::singleton('DB');
    $sql = "SELECT COUNT(*) FROM ".TAB_MEMBER." WHERE  num_oid = '"._OID."' and str_nick='$id'";
    $count = $DB->sqlFetchOne($sql);

    

	//$val = WebApp::TextPilt($id);


    if ($count || in_array($id,$except_id) ) {
        $ret = array(
            'Code' => '99',
            'Message' => '사용할 수 없는 닉네임입니다.'
        );
    
    } else if($nn) {
		 $ret = array(
            'Code' => '98',
            'Message' => '특수문자는 사용불가합니다.'
        );
    }else{
        $ret = array(
            'Code' => '00',
            'Message' => '사용 가능합니다'
        );
    }

echo $JSON->encode($ret);
?>